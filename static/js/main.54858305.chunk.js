(this["webpackJsonpmovies-catalog-ts"]=this["webpackJsonpmovies-catalog-ts"]||[]).push([[0],{59:function(e,t,a){e.exports=a(88)},64:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(13),r=a.n(c),i=(a(64),a(18)),s=a(15),l=a(48),u=a(49),m=a(34),h=a(11),d="FETCH_MOVIES",g="SEARCH_MOVIES",p={movies:[],searchTerm:"",fetching:!1,page:0,totalPages:null,searchResults:[]};function f(e,t){return e.filter((function(e){return-1!==e.name.search(new RegExp(t,"i"))}))}var v=Object(s.c)({movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"".concat(d,"_PENDING"):return Object(h.a)(Object(h.a)({},e),{},{fetching:!0});case"".concat(d,"_FULFILLED"):return a=[].concat(Object(m.a)(e.movies),Object(m.a)(t.payload.movies.map((function(e){return Object(h.a)({},e)})))),Object(h.a)(Object(h.a)({},e),{},{movies:a,page:t.payload.page,totalPages:t.payload.totalPages,fetching:!1,searchResults:f(a,e.searchTerm)});case"".concat(d,"_REJECTED"):return Object(h.a)(Object(h.a)({},e),{},{fetching:null});case g:return Object(h.a)(Object(h.a)({},e),{},{searchTerm:t.payload,searchResults:f(e.movies,t.payload)});default:return e}}}),b=Object(s.d)(v,Object(s.a)(l.a,u.a)),E=a(16),O=a(17),j=a(12),y=a(21),x=a(19),k=a(105),w=a(4),S=a(50),B=a.n(S),M=a(51),N=a.n(M),F={get:function(e){return N.a.get("api/page".concat(e,".json"))}},I={fetch_movies:function(e){return{type:d,payload:function(){return new Promise((function(t,a){F.get(e).then((function(e){var a=parseInt(e.data.page["page-num-requested"],10),n=parseInt(e.data.page["total-content-items"],10),o=parseInt(e.data.page["page-size-requested"],10),c=Math.ceil(n/o);console.log(c),t({movies:e.data.page["content-items"].content,page:a,totalPages:c})}),(function(e){return a(e)}))}))}}},search_movies:function(e){return{type:g,payload:e}}},C=I,T=function(e){return"images/".concat(e)},_=Object(w.a)((function(){return{imageBox:{flexGrow:1,width:"100%",borderWidth:1,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",display:"flex",justifyContent:"center",paddingBottom:"148%"},movieBox:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%"},title:{fontSize:16,marginTop:24,width:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}}))((function(e){var t=e.name,a=e["poster-image"],n=e.classes;return o.a.createElement(k.a,{item:!0,xs:4,className:"grid",title:t},o.a.createElement("div",{className:n.movieBox},o.a.createElement("div",{className:n.imageBox,style:{backgroundImage:"url(".concat(T(a),"), url(").concat(T("poster_missing.png"),")")}}),o.a.createElement("span",{className:n.title},t)))})),R=a(107),D=a(106),P=a(56),W=a.n(P),L=a(55),G=a.n(L),z=a(108),H=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).state={},n.searchMovies=n.searchMovies.bind(Object(j.a)(n)),n}return Object(O.a)(a,[{key:"componentWillUnmount",value:function(){(0,this.props.dispatch)(C.search_movies(""))}},{key:"searchMovies",value:function(e){var t=e.target.value;(0,this.props.dispatch)(C.search_movies(t))}},{key:"render",value:function(){var e=this.props.classes;return o.a.createElement("div",{className:e.container},o.a.createElement(z.a,{placeholder:"Title search",autoFocus:!0,fullWidth:!0,disableUnderline:!0,className:e.input,onChange:this.searchMovies}))}}]),a}(n.Component),U=Object(i.b)((function(e){return{movie:e.movie}}))(Object(w.a)((function(){return{container:{display:"flex"},input:{color:"#333",width:"100%",background:"#DDD",padding:"4px 10px"}}}))(H)),J=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).state={showSearch:!1},n.toggleSearch=n.toggleSearch.bind(Object(j.a)(n)),n}return Object(O.a)(a,[{key:"toggleSearch",value:function(){this.setState((function(e){return{showSearch:!e.showSearch}}))}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.onSearch,n=this.state.showSearch;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:t.container},o.a.createElement(R.a,{className:t.buttonBack},o.a.createElement(G.a,null)),o.a.createElement(D.a,{variant:"h1",className:t.heading},"Romantic Comedy"),o.a.createElement(R.a,{className:t.buttonSearch,onClick:this.toggleSearch},o.a.createElement(W.a,null))),n&&o.a.createElement(U,{onSearch:a,className:t.searchBar}))}}]),a}(n.Component),q=Object(w.a)((function(){return{heading:{color:"#FFF",fontSize:19,flexGrow:1,padding:"14px 0px",fontFamily:"Titillium Web",paddingBottom:0},container:{display:"flex"},buttonSearch:{color:"#FFF",paddingRight:0,paddingBottom:0},buttonBack:{color:"#FFF",paddingLeft:0,paddingBottom:0},searchBar:{}}}))(J);a(87);var V=function(e){Object(y.a)(a,e);var t=Object(x.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).state={},n.trackScrolling=n.trackScrolling.bind(Object(j.a)(n)),n.fetchMovies=n.fetchMovies.bind(Object(j.a)(n)),n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){document.getElementById("catalog-contatiner").addEventListener("scroll",this.trackScrolling),this.fetchMovies()}},{key:"componentWillUnmount",value:function(){document.getElementById("catalog-contatiner").removeEventListener("scroll",this.trackScrolling)}},{key:"fetchMovies",value:function(){var e=this.props,t=e.dispatch,a=e.movie,n=a.page,o=a.totalPages,c=a.fetching;if(console.log(a),!c&&(o&&n<o||null===o))t(C.fetch_movies(a.page+1));else if(n===o){document.getElementById("catalog-contatiner").removeEventListener("scroll",this.trackScrolling)}}},{key:"trackScrolling",value:function(e){(function(e){return e.target.scrollHeight-e.target.scrollTop-50<e.target.clientHeight})(e)&&this.fetchMovies()}},{key:"renderMovies",value:function(){var e=this.props,t=e.movie,a=e.classes,n=t.searchResults.map((function(e,t){return o.a.createElement(_,Object.assign({key:t},e))}));return B.a.chunk(n,3).map((function(e,t){return o.a.createElement(k.a,{key:t,container:!0,spacing:32,className:a.group},e)}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return o.a.createElement(k.a,{container:!0,className:t.root},o.a.createElement(k.a,{item:!0,xs:12,className:t.header},o.a.createElement(q,{onSearch:this.searchMovies,onSearchClear:function(){return e.searchMovies(null)}})),o.a.createElement(k.a,{item:!0,xs:12,className:t.catalog,id:"catalog-contatiner"},this.renderMovies()))}}]),a}(n.Component),A=Object(i.b)((function(e){return{movie:e.movie}}))(Object(w.a)((function(){return{root:{flexGrow:1,flexDirection:"column",flexWrap:"nowrap"},catalog:{flexGrow:1,overflowX:"hidden",overflowY:"auto",paddingTop:64},header:{padding:"0px 30px 30px 30px",flexGrow:0,flexBasis:"auto",zIndex:1,position:"absolute",width:"100%",background:"linear-gradient(#000, #000 54%, transparent)"},group:{margin:0,marginBottom:90,width:"100%",padding:"0px 15px","& > div.grid":{padding:15,paddingBottom:0,paddingTop:0}}}}))(V)),X=function(){return o.a.createElement(i.a,{store:b},o.a.createElement(A,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.54858305.chunk.js.map