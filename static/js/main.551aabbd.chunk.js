(this["webpackJsonpmovies-catalog-ts"]=this["webpackJsonpmovies-catalog-ts"]||[]).push([[0],{5:function(e,t,a){e.exports={root:"app_root__LD5r2",catalog:"app_catalog__2_t8T",header:"app_header__2pS8E",group:"app_group__19ShV",grid:"app_grid__30wlT",imageBox:"app_imageBox__1HEw3",movieBox:"app_movieBox__TsqPm",title:"app_title__3EWwZ",heading:"app_heading__2pttv",container:"app_container__3c5x-",buttonSearch:"app_buttonSearch__2oElV",buttonBack:"app_buttonBack__nOSAQ",searchBar:"app_searchBar__3Fl1q"}},59:function(e,t,a){e.exports=a(87)},64:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(14),o=a.n(r),i=(a(64),a(19)),s=a(16),l=a(48),u=a(49),m=a(34),h=a(12),p="FETCH_MOVIES",g="SEARCH_MOVIES",v={movies:[],searchTerm:"",fetching:!1,page:0,totalPages:null,searchResults:[]};function d(e,t){return e.filter((function(e){return-1!==e.name.search(new RegExp(t,"i"))}))}var f=Object(s.c)({movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0,a=[];switch(t.type){case"".concat(p,"_PENDING"):return Object(h.a)(Object(h.a)({},e),{},{fetching:!0});case"".concat(p,"_FULFILLED"):return a=[].concat(Object(m.a)(e.movies),Object(m.a)(t.payload.movies.map((function(e){return Object(h.a)({},e)})))),Object(h.a)(Object(h.a)({},e),{},{movies:a,page:t.payload.page,totalPages:t.payload.totalPages,fetching:!1,searchResults:d(a,e.searchTerm)});case"".concat(p,"_REJECTED"):return Object(h.a)(Object(h.a)({},e),{},{fetching:null});case g:return Object(h.a)(Object(h.a)({},e),{},{searchTerm:t.payload,searchResults:d(e.movies,t.payload)});default:return e}}}),b=Object(s.d)(f,Object(s.a)(l.a,u.a)),_=a(17),E=a(18),O=a(13),j=a(22),y=a(20),k=a(105),S=a(50),w=a.n(S),M=a(51),B=a.n(M),N={get:function(e){return B.a.get("/movies-catalog-ts/api/page".concat(e,".json"))}},x={fetch_movies:function(e){return{type:p,payload:function(){return new Promise((function(t,a){N.get(e).then((function(e){var a=parseInt(e.data.page["page-num-requested"],10),n=parseInt(e.data.page["total-content-items"],10),c=parseInt(e.data.page["page-size-requested"],10),r=Math.ceil(n/c);console.log(r),t({movies:e.data.page["content-items"].content,page:a,totalPages:r})}),(function(e){return a(e)}))}))}}},search_movies:function(e){return{type:g,payload:e}}},I=x,C=a(5),T=a.n(C),D=function(e){return"/movies-catalog-ts/images/".concat(e)},P=function(e){var t=e.name,a=e["poster-image"];return c.a.createElement(k.a,{item:!0,xs:4,className:T.a.grid,title:t},c.a.createElement("div",{className:T.a.movieBox},c.a.createElement("div",{className:T.a.imageBox,style:{backgroundImage:"url(".concat(D(a),"), url(").concat(D("poster_missing.png"),")")}}),c.a.createElement("span",{className:T.a.title},t)))},R=a(107),L=a(106),F=a(56),W=a.n(F),H=a(55),q=a.n(H),U=a(4),V=a(108),J=function(e){Object(j.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(_.a)(this,a),(n=t.call(this,e)).state={},n.searchMovies=n.searchMovies.bind(Object(O.a)(n)),n}return Object(E.a)(a,[{key:"componentWillUnmount",value:function(){(0,this.props.dispatch)(I.search_movies(""))}},{key:"searchMovies",value:function(e){var t=e.target.value;(0,this.props.dispatch)(I.search_movies(t))}},{key:"render",value:function(){var e=this.props.classes;return c.a.createElement("div",{className:e.container},c.a.createElement(V.a,{placeholder:"Title search",autoFocus:!0,fullWidth:!0,disableUnderline:!0,className:e.input,onChange:this.searchMovies}))}}]),a}(n.Component),A=Object(i.b)((function(e){return{movie:e.movie}}))(Object(U.a)((function(){return{container:{display:"flex"},input:{color:"#333",width:"100%",background:"#DDD",padding:"4px 10px"}}}))(J)),z=function(e){Object(j.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(_.a)(this,a),(n=t.call(this,e)).state={showSearch:!1},n.toggleSearch=n.toggleSearch.bind(Object(O.a)(n)),n}return Object(E.a)(a,[{key:"toggleSearch",value:function(){this.setState((function(e){return{showSearch:!e.showSearch}}))}},{key:"render",value:function(){var e=this.props.onSearch,t=this.state.showSearch;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:T.a.container},c.a.createElement(R.a,{className:T.a.buttonBack},c.a.createElement(q.a,null)),c.a.createElement(L.a,{variant:"h1",className:T.a.heading},"Romantic Comedy"),c.a.createElement(R.a,{className:T.a.buttonSearch,onClick:this.toggleSearch},c.a.createElement(W.a,null))),t&&c.a.createElement(A,{onSearch:e,className:T.a.searchBar}))}}]),a}(n.Component);var G=function(e){Object(j.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(_.a)(this,a),(n=t.call(this,e)).state={},n.trackScrolling=n.trackScrolling.bind(Object(O.a)(n)),n.fetchMovies=n.fetchMovies.bind(Object(O.a)(n)),n}return Object(E.a)(a,[{key:"componentDidMount",value:function(){document.getElementById("catalog-contatiner").addEventListener("scroll",this.trackScrolling),this.fetchMovies()}},{key:"componentWillUnmount",value:function(){document.getElementById("catalog-contatiner").removeEventListener("scroll",this.trackScrolling)}},{key:"fetchMovies",value:function(){var e=this.props,t=e.dispatch,a=e.movie,n=a.page,c=a.totalPages;if(!a.fetching&&(c&&n<c||null===c))t(I.fetch_movies(a.page+1));else if(n===c){document.getElementById("catalog-contatiner").removeEventListener("scroll",this.trackScrolling)}}},{key:"trackScrolling",value:function(e){(function(e){return e.target.scrollHeight-e.target.scrollTop-50<e.target.clientHeight})(e)&&this.fetchMovies()}},{key:"renderMovies",value:function(){var e=this.props.movie.searchResults.map((function(e,t){return c.a.createElement(P,Object.assign({key:t},e))}));return w.a.chunk(e,3).map((function(e,t){return c.a.createElement(k.a,{key:"j",container:!0,spacing:32,className:T.a.group},e)}))}},{key:"render",value:function(){var e=this;return c.a.createElement(k.a,{container:!0,className:T.a.root},c.a.createElement(k.a,{item:!0,xs:12,className:T.a.header},c.a.createElement(z,{onSearch:this.searchMovies,onSearchClear:function(){return e.searchMovies(null)}})),c.a.createElement(k.a,{item:!0,xs:12,className:T.a.catalog,id:"catalog-contatiner"},this.renderMovies()))}}]),a}(n.Component),Q=Object(i.b)((function(e){return{movie:e.movie}}))(G),Z=function(){return c.a.createElement(i.a,{store:b},c.a.createElement(Q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.551aabbd.chunk.js.map